<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <svg id="graph">
    </svg>
    <script>
         class Circle {
            constructor(pos) {
                this.el = document.createElementNS("http://www.w3.org/2000/svg", "circle");
                this.el.classList.add("circle");
                this.el.setAttribute("r", "20");
                this.el.setAttribute("stroke", "black");
                this.el.setAttribute("stroke-width", "4");
                this.setPosition(pos);
            }

            setPosition(pos) {
                this.el.setAttribute("cx", pos.cx);
                this.el.setAttribute("cy", pos.cy);
            }

            getPosition() {
                return {
                    cx: this.el.getAttribute("cx"),
                    cy: this.el.getAttribute("cy")
                };
            }

            getHtmlEl() {
                return this.el;
            }
        }

        class Line {
            constructor(pos) {
                this.el = document.createElementNS("http://www.w3.org/2000/svg", "line");
                this.el.classList.add("line");
                this.el.setAttribute("stroke", "red");
                this.el.setAttribute("stroke-width", "20");
                this.setPosition(pos);
            }

            setPosition(pos) {
                this.el.setAttribute("x1", pos.x1);
                this.el.setAttribute("y1", pos.y1);
                this.el.setAttribute("x2", pos.x2);
                this.el.setAttribute("y2", pos.y2);
            }

            getPosition() {
                return {
                    x1: this.el.getAttribute("x1"),
                    y1: this.el.getAttribute("y1"),
                    x2: this.el.getAttribute("x2"),
                    y2: this.el.getAttribute("y1")
                };
            }

            getHtmlEl() {
                return this.el;
            }
        }

        class Graph {
            constructor(el) {
                this.el = el;
                this.elements = [];

                this.setSize();

                this.el.onmousedown = this.mouseDown.bind(this);
                this.el.onmousemove = this.mouseMove.bind(this);
            }

            mouseDown(event) {
                this.drawStart = true;

                let line = new Line({
                    x1: event.pageX,
                    y1: event.pageY,
                    x2: event.pageX,
                    y2: event.pageY
                });

                let circle = new Circle({
                    cx: event.pageX,
                    cy: event.pageY,
                });

                this.current = line;
                this.el.appendChild(line.getHtmlEl());
                this.el.appendChild(circle.getHtmlEl());
            }

            mouseUp(event) {
                this.drawStart = false;
                this.current = null;
            }

            mouseMove(event) {
                if (this.drawStart && this.current) {
                    let pos = this.current.getPosition();
                    pos.x2 = event.pageX;
                    pos.y2 = event.pageY;
                    this.current.setPosition(pos);
                }
            }

            setSize() {
                this.el.setAttribute("width", window.innerWidth);
                this.el.setAttribute("height", window.innerHeight);
            }
        }

        window.onload = () => {
            window.graph = new Graph(document.getElementById("graph"));
        };
    </script>
</body>

</html>